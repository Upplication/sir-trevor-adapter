!function(t){var e=window,r=e.$||e.jQuery,o=e._||e.lodash;if(!r)throw new Error("SirTrevorAdapter requires jQuery");if(!o)throw new Error("SirTrevorAdapter requires lodash");e.SirTrevorAdapter=t(r,o)}(function(t,e){"use strict";var r={text:"<%= text %>",quote:"<quote><%= text %></quote>",image:'<div><img src="<%- src %></div>',heading:"<h2><%= text %></h2>",list:"<ul><% _.each(listItems, function(e) { %><li><%- e %></li><% }) %></ul>",tweet:"<div></div>",button:"<%= text %>",widget:"<%= text %>",video:function(t){var r={vimeo:{regex:/(?:http[s]?:\/\/)?(?:www.)?vimeo\.co(?:.+(?:\/)([^\/].*)+$)/,html:'<iframe src="<%= protocol %>//player.vimeo.com/video/<%= remote_id %>?title=0&byline=0" width="580" height="320" frameborder="0"></iframe>'},youtube:{regex:/^.*(?:(?:youtu\.be\/)|(?:youtube\.com)\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*)/,html:'<iframe src="<%= protocol %>//www.youtube.com/embed/<%= remote_id %>" width="580" height="320" frameborder="0" allowfullscreen></iframe>'}};if(!r.hasOwnProperty(t.source))return"";var o=r[t.source],i="file:"===window.location.protocol?"http:":window.location.protocol;return e.template(o.html,{protocol:i,remote_id:t.remote_id})}},o={elementEnclosingTag:"div",elementClass:"st-render",addElementTypeClass:!0,attrName:"st"},i=function(t){t=t||{},this.templates=e.defaults(t.templates||{},r),delete t.template,this.config=e.defaults(o,t)};return i.prototype._isSirTrevorData=function(t){return t&&t.type&&t.data&&e.isObject(t.data)},i.prototype.renderType=function(t,r){var o=this.templates[t];return o?e.isFunction(o)?o(r):e.template(o,r):(console.error("No template for type "+t),"")},i.prototype.map=function(e){if(!this._isSirTrevorData(e))return console.error(JSON.stringify(e)+" is not a valid SirTrevor object"),"";var r=this.renderType(e.type,e.data),o=[this.config.elementClass];this.config.addElementTypeClass&&o.push(this.config.elementClass+"-"+e.type);var i=t("<"+this.config.elementEnclosingTag+">",{"class":o.join(" ")});return i.attr("data-"+this.config.attrName,JSON.stringify(e)),i.html(r),i[0].outerHTML},i.prototype.toHTML=function(r){e.isArray(r)||(r=[r]);t("<"+this.config.elementEnclosingTag+">",{"class":this.config.elementClass+"-container"});return'<div class="st-render-container">'+r.map(this.map,this).join("\n")+"</div>"},i.prototype.fromJSON=i.prototype.toHTML,i.prototype.toJSON=function(e){var r=this,o=t(e),i=t(o),n=[];return i.find(".st-render").each(function(e,o){n.push(t(o).data(r.config.attrName))}),n},i.prototype.fromHTML=i.prototype.toJSON,i});