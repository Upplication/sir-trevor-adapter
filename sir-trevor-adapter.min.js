!function(e){var t=window,r=t.$||t.jQuery,o=t._||t.lodash;if(!r)throw new Error("SirTrevorAdapter requires jQuery");if(!o)throw new Error("SirTrevorAdapter requires lodash");t.SirTrevorAdapter=e(r,o)}(function(e,t){"use strict";var r={text:"<%= text %>",quote:"<quote><%= text %></quote>",image:'<div><img src="<%- file.url %>"/></div>',heading:"<h2><%= text %></h2>",list:"<ul><% _.each(listItems, function(e) { %><li><%- e.content %></li><% }) %></ul>",tweet:"<div></div>",widget:"<%= text %>",button:function(t){var r=e("<a>");return r.html(t.text),r.attr("href",t.href),Object.keys(t).filter(function(e){return/^css\-/.test(e)}).forEach(function(e){var o=e.replace(/^css\-/,"");r.css(o,t[e])}),r.css("display","block"),r.css("box-sizing","border-box"),r.css("border-style","solid"),r.css("padding-top","0.8em"),r.css("padding-bottom","0.5em"),r.css("text-align","center"),r.css("margin","0 auto"),r[0].outerHTML},video:function(e){var r={vimeo:{regex:/(?:http[s]?:\/\/)?(?:www.)?vimeo\.co(?:.+(?:\/)([^\/].*)+$)/,html:'<iframe src="<%= protocol %>//player.vimeo.com/video/<%= remote_id %>?title=0&byline=0" width="580" height="320" frameborder="0"></iframe>'},youtube:{regex:/^.*(?:(?:youtu\.be\/)|(?:youtube\.com)\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*)/,html:'<iframe src="<%= protocol %>//www.youtube.com/embed/<%= remote_id %>" width="580" height="320" frameborder="0" allowfullscreen></iframe>'}};if(!r.hasOwnProperty(e.source))return"";var o=r[e.source],i="file:"===window.location.protocol?"http:":window.location.protocol;return t.template(o.html,{protocol:i,remote_id:e.remote_id})},map:function(e){var r=t.template("https://maps.googleapis.com/maps/api/staticmap?size=<%= width %>x<%= height %>&center=<%= address %>&markers=|<%= address %>&zoom=<%= zoom %>&scale=2",e),o=t.template("http://maps.google.com/maps?q=<%= address %>",e),i='<a href="<%= map_ref %>"><img src="<%= img_src %>" /></a>';return t.template(i,{img_src:r,map_ref:o})}},o={elementEnclosingTag:"div",elementClass:"st-render",addElementTypeClass:!0,containerClass:"st-render-container",attrName:"st"},i=function(e){e=e||{},this.templates=t.defaults(e.templates||{},r),delete e.template,this.config=t.defaults(o,e)};return i.prototype._isSirTrevorData=function(e){return e&&e.type&&e.data&&t.isObject(e.data)},i.prototype.renderType=function(e,r){if(!e)throw new Error("type can't be undefined");var o=this.templates[e];if(!o){var i=Object.keys(this.templates).reduce(function(t,r){return null!==t?t:r==e.substring(0,r.length)?r:null},null);if(!i)return console.error("No template for type "+e),"";o=this.templates[i]}var s="";try{s=t.isFunction(o)?o(r):t.template(o,r)}catch(a){console.error("Error while generating templated view for "+e),console.error(a)}return s},i.prototype.map=function(t){if(!this._isSirTrevorData(t))return console.error(JSON.stringify(t)+" is not a valid SirTrevor object"),"";var r=this.renderType(t.type,t.data),o=[this.config.elementClass];this.config.addElementTypeClass&&o.push(this.config.elementClass+"-"+t.type);var i=e("<"+this.config.elementEnclosingTag+">",{"class":o.join(" ")});return i.attr("data-"+this.config.attrName,JSON.stringify(t)),i.html(r),i[0].outerHTML},i.prototype.toHTML=function(r){var o=!0;t.isArray(r)||(r=[r],o=!1);var i=(e("<"+this.config.elementEnclosingTag+">",{"class":this.config.elementClass+"-container"}),r.map(this.map,this).join("\n"));return o?'<div class="'+this.config.containerClass+'">'+i+"</div>":i},i.prototype.fromJSON=i.prototype.toHTML,i.prototype.toJSON=function(t){var r=this,o=e(t),i=e(o),s=[];return i.find(".st-render").each(function(t,o){s.push(e(o).data(r.config.attrName))}),s},i.prototype.fromHTML=i.prototype.toJSON,i.Defaults={},i.Defaults.Templates=r,i});