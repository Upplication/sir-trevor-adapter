!function(t){var e=window,r=e.$||e.jQuery,o=e._||e.lodash;if(!r)throw new Error("SirTrevorAdapter requires jQuery");if(!o)throw new Error("SirTrevorAdapter requires lodash");e.SirTrevorAdapter=t(r,o)}(function(t,e){"use strict";var r={text:function(t){var r="<%= text %>";return t.align&&(r='<div style="text-align:<%= align %>">'+r+"</div>"),e.template(r,t)},quote:"<quote><%= text %></quote>",image:'<div><img src="<%- file.url %>"/></div>',heading:function(t){var r="<h2><%= text %></h2>";return t.align&&(r='<div style="text-align:<%= align %>">'+r+"</div>"),e.template(r,t)},list:"<ul><% _.each(listItems, function(e) { %><li><%- e.content %></li><% }) %></ul>",tweet:"<div></div>",widget:"<%= text %>",button:function(e){var r=t("<a>");return r.html(e.text),r.attr("href",e.href),Object.keys(e).filter(function(t){return/^css\-/.test(t)}).forEach(function(t){var o=t.replace(/^css\-/,"");r.css(o,e[t])}),r.css("overflow","hidden"),r.css("display","block"),r.css("line-height","normal"),r.css("box-sizing","border-box"),r.css("border-style","solid"),r.css("text-align","center"),r.css("margin","0 auto"),r.find("*").css("margin","0"),r[0].outerHTML},video:function(t){var r={vimeo:{regex:/(?:http[s]?:\/\/)?(?:www.)?vimeo\.co(?:.+(?:\/)([^\/].*)+$)/,html:'<iframe src="<%= protocol %>//player.vimeo.com/video/<%= remote_id %>?title=0&byline=0" width="580" height="320" frameborder="0"></iframe>'},youtube:{regex:/^.*(?:(?:youtu\.be\/)|(?:youtube\.com)\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*)/,html:'<iframe src="<%= protocol %>//www.youtube.com/embed/<%= remote_id %>" width="580" height="320" frameborder="0" allowfullscreen></iframe>'}};if(!r.hasOwnProperty(t.source))return"";var o=r[t.source],i="file:"===window.location.protocol?"http:":window.location.protocol;return e.template(o.html,{protocol:i,remote_id:t.remote_id})},map:function(t){var r=e.template("https://maps.googleapis.com/maps/api/staticmap?size=<%= width %>x<%= height %>&center=<%= address %>&markers=|<%= address %>&zoom=<%= zoom %>&scale=2",t),o=e.template("http://maps.google.com/maps?q=<%= address %>",t),i='<a href="<%= map_ref %>"><img src="<%= img_src %>" /></a>';return e.template(i,{img_src:r,map_ref:o})},spacer:function(e){var r=t("<div>");return r.css("margin",e.height+e.units+" 0"),r[0].outerHTML}},o={elementEnclosingTag:"div",elementClass:"st-render",addElementTypeClass:!0,containerClass:"st-render-container",attrName:"st"},i=function(t){t=t||{},this.templates=e.defaults(t.templates||{},r),delete t.template,this.config=e.defaults(o,t)};return i.prototype._isSirTrevorData=function(t){return t&&t.type&&t.data&&e.isObject(t.data)},i.prototype.renderType=function(t,r){if(!t)throw new Error("type can't be undefined");var o=this.templates[t];if(!o){var i=Object.keys(this.templates).reduce(function(e,r){return null!==e?e:r==t.substring(0,r.length)?r:null},null);if(!i)return console.error("No template for type "+t),"";o="html"==r.type&&r.text&&r.text.length>0?this.templates.text:this.templates[i]}var n="";try{n=e.isFunction(o)?o(r):e.template(o,r)}catch(a){console.error("Error while generating templated view for "+t),console.error(a)}return n},i.prototype.map=function(e){if(!this._isSirTrevorData(e))return console.error(JSON.stringify(e)+" is not a valid SirTrevor object"),"";var r=this.renderType(e.type,e.data),o=[this.config.elementClass];this.config.addElementTypeClass&&o.push(this.config.elementClass+"-"+e.type);var i=t("<"+this.config.elementEnclosingTag+">",{"class":o.join(" ")});return i.attr("data-"+this.config.attrName,JSON.stringify(e)),i.html(r),i[0].outerHTML},i.prototype.toHTML=function(r){var o=!0;e.isArray(r)||(r=[r],o=!1);var i=(t("<"+this.config.elementEnclosingTag+">",{"class":this.config.elementClass+"-container"}),r.map(this.map,this).join("\n"));return o?'<div class="'+this.config.containerClass+'">'+i+"</div>":i},i.prototype.fromJSON=i.prototype.toHTML,i.prototype.toJSON=function(e){var r=this,o=t(e),i=t(o),n=[];return i.find(".st-render").each(function(e,o){n.push(t(o).data(r.config.attrName))}),n},i.prototype.fromHTML=i.prototype.toJSON,i.Defaults={},i.Defaults.Templates=r,i});